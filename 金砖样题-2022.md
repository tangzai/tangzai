 

# 第二阶段： 安全运营

**背景：**作为信息安全技术人员必须能够掌握操作系统加固与安全管控、防火墙一般配置、常见服务配置等相关技能，利用这些技能我们能够进一步保障重要业务平稳运行。

安全运营阶段题目主要包含：操作系统安全加固，iptables 防火墙配置，应用服务安全配置等内容。

 **wmic帮助查案**

```bash
C:\Users\19374>wmic /?

WMIC 已弃用。

[全局开关] <命令>

可以使用以下全局开关:
/NAMESPACE           别名在其上操作的命名空间的路径。
/ROLE                包含别名定义的角色的路径。
/NODE                别名在其上操作的服务器。
/IMPLEVEL            客户端模拟级别。
/AUTHLEVEL           客户端身份验证级别。
/LOCALE              客户端应使用的语言 ID。
/PRIVILEGES          启用或禁用所有权限。
/TRACE               将调试信息输出到 stderr。
/RECORD              记录所有输入命令和输出内容。
/INTERACTIVE         设置或重置交互模式。
/FAILFAST            设置或重置 FailFast 模式。
/USER                会话期间要使用的用户。
/PASSWORD            登录会话时要使用的密码。
/OUTPUT              指定输出重定向模式。
/APPEND              指定输出重定向模式。
/AGGREGATE           设置或重置聚合模式。
/AUTHORITY           指定连接的 <授权类型>。
/?[:<BRIEF|FULL>]    用法信息。
```



 

**项目** 1.   **系统安全管控**

 

**任务一** Windows **加固**

 

你作为 A 公司的安全运营人员，当前有一部 Windows 系统电脑需要加固， 请按照下面要求完成相关操作，保障系统安全运行。

\1.    通过 wmic 工具将当前系统服务简要信息列出，并存储为 html 格式使用的命令是；

`/output:services.html`：输出的文件路径

`SERVOCE get`：列出当前服务的信息

`/format:hfrom`：以HTML表单的格式列出

```bash
C:\Users\19374>wmic /output:services.html SERVICE get /format:hform
```



\2.    通过 wmic 工具将当前系统用户详细信息列出，使用的命令是；

如果是需要使用`/format`来做格式处理的话，必须使用`get`

```bash
C:\Users\19374>wmic USERACCOUNT get /format:list


AccountType=512
Caption=WeiJay_host\19374
Description=
Disabled=FALSE
Domain=WeiJay_host
FullName=weijay Hou
InstallDate=
LocalAccount=TRUE
Lockout=FALSE
Name=19374
PasswordChangeable=TRUE
PasswordExpires=FALSE
PasswordRequired=TRUE
SID=S-1-5-21-2587542256-521516679-1296153846-1001
SIDType=1
Status=OK
```



\3.    通过 sc 工具管理服务，启动 mysql 服务的命令是；

```
sc start mysql
```



\4.    通过命令行 CMD 管理 Windows 防火墙，允许 192.168.1.100 连接所有端口的命令是；

`add rule `：添加规则

`name`：指定名字

`dir`：指定方向

`action`：指定动作（allow | block）

`protocol`：指定协议

`remoteip`：指定IP地址

```bash
C:\Windows\system32>netsh advfirewall firewall add rule name="ALLOW 192.168.1.100" dir=in action=allow protocol=tcp remoteip=192.168.1.100
确定。
```



\5.    通过命令行 CMD 配置 Windows 防火墙，阻断 tcp/3389 端口连接的命令是；

```bash
C:\Windows\system32>netsh advfirewall firewall add rule name="block" protocol=tcp dir=in localport=3389 action=block
确定。
```



\6.    通过命令行 CMD 管理 Windows 用户，添加 skill 用户至 administrators 组的命令是。

 ```bash
 C:\Windows\system32>net localgroup Administrators skill /add
 命令成功完成。
 ```



**任务二** Linux **加固**

 

你作为 A 公司的安全运营人员，当前有一部 Linux 系统电脑需要加固，请按照下面要求完成相关操作，保障系统安全运行。

\1.    Linux 操作系统中存储实时内存信息文件的路径是；

```powershell
/proc/meminfo
```



解析：

```
/proc/cpuinfo：包含有关 CPU 的信息。
/proc/meminfo：包含有关 RAM 使用情况的信息。
/proc/version：包含有关 Linux 内核版本和 gcc 版本的信息。
/proc/net：包含有关网络适配器及统计信息。
```



\2.    Linux 操作系统中存储开机自动挂载磁盘信息的文件路径是；

```
[root@localhost proc]# cat /etc/fstab
```



\3.    Linux 操作系统 SSH 服务禁用 root 用户登陆要修改的配置是；

```bash
[root@localhost ~]# vim /etc/ssh/sshd_config
PermitRootLogin no
```

\4.    Linux 操作系统 SSH 服务开机端口网关需要修改的配置是；

```
SSH端口转发：可以当作代理服务器来使用；当A主机要访问C主机的服务，但是A主机又无法直接到达时，就可以先SSH到B主机，并开启某个端口，将某些特定流量通过这个读端口进行转发，由主机B做二次转发和处理

man 手册解释：
     GatewayPorts
             Specifies whether remote hosts are allowed to connect to ports forwarded for the client.
             By default, sshd(8) binds remote port forwardings to the loopback address.  This prevents
             other remote hosts from connecting to forwarded ports.  GatewayPorts can be used to spec‐
             ify that sshd should allow remote port forwardings to bind to non-loopback addresses, thus
             allowing other hosts to connect.  The argument may be no to force remote port forwardings
             to be available to the local host only, yes to force remote port forwardings to bind to
             the wildcard address, or clientspecified to allow the client to select the address to
             which the forwarding is bound.  The default is no.
```

```
[root@localhost proc]# vim /etc/ssh/sshd_config
GatewayPorts YES
```

\5.    Linux 操作系统 VSFTPD 服务默认的匿名用户名是；

`ftp`

\6.    Linux 操作系统 VSFTPD 服务禁用匿名需要进行的配置是。

```bash
man 手册：
       anonymous_enable
              Controls whether anonymous logins are permitted or not. If enabled,  both  the  usernames
              ftp and anonymous are recognised as anonymous logins.

              Default: YES

```

```
[root@localhost ~]# vim /etc/vsftpd/vsftpd.conf
anonymous_enable=NO
```

**项目** ***2.\***   **防火墙安全管控**

 

**任务三 工作站防火墙配置**

 

你作为 A 公司的安全运营人员，当前有一部 Linux 系统的工作站防火墙需要配置，请按照下面要求完成相关操作，保障系统安全运行。

\1.    使用 iptables 防火墙控制流量转发，需要操作的链是哪条；

`forward`

```
解析：
	iptales 链一共有5条，分别时：
		* INPUT
		* OUTPUT
		* FORWARD
		* PREROUTING
		* POSTROUTING
```



\2.    使用 iptables 防火墙控制流量进入，限制进入流量 IP 地址使用的选项是；

`iptables -A INPUT -s 192.168.1.100 -j DROP`

\3.    使用 iptables 防火墙控制默认规则拒绝所有进入流量，需使用的命令是；

`[root@localhost ~]# iptables -t filter -A INPUT -j DROP`

\4.    使用 iptables 防火墙配置工作站类型防火墙，出口方向一般执行什么操作；

`ACCEPT`

```
rhel8 中的防火墙默认策略就是 ACCEPT
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
ACCEPT     udp  --  anywhere             anywhere             udp dpt:domain
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:domain
ACCEPT     udp  --  anywhere             anywhere             udp dpt:bootps
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:bootps

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
ACCEPT     all  --  anywhere             192.168.122.0/24     ctstate RELATED,ESTABLISHED
ACCEPT     all  --  192.168.122.0/24     anywhere
ACCEPT     all  --  anywhere             anywhere
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
ACCEPT     udp  --  anywhere             anywhere             udp dpt:bootpc
```



\5.    使用 iptables 防火墙配置 tcp/22 端新建连接速度，需使用的命令是什么；

```
iptables -A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW -m limit --limit 10/min --limit-burst 20 -j ACCEPT
```

```
-A INPUT：将规则添加到INPUT链的末尾。
-p tcp：指定协议为TCP。
--dport 22：指定目标端口为22（SSH端口）。
-m conntrack --ctstate NEW：匹配状态为NEW的连接。
-m limit --limit 10/min --limit-burst 20：限制连接速度为每分钟最多10个新连接，允许短时间内突发性的最多20个连接。
-j ACCEPT：如果连接符合限速条件，则接受连接。
```

\6.    使用 iptables 防护墙配置 nat 地址转换需要操作哪张表；

`nat`

\7.   使用iptables 防火墙配置放行从 192.168.1.100 至 192.168.3.100 需使用的命令是；

`[root@localhost ~]# iptables -t filter -A INPUT -m iprange --src-range 192.168.1.100-192.168.3.100 -j ACCEPT`                                                                                       

\8.    使用 iptables 防火墙配置工作站类型防火墙时，哪一接口流量应全部放行；

```
本地回环接口
iptables -A INPUT -i lo -j ACCEPT
```



\9.    使用 iptables 防火墙配置工作站类型防火墙时，执行什么命令可以清除所有规则。

`[root@localhost ~]# iptables -F`

**项目** 3.   **应用服务安全**

 

**任务四** VSFTPD **服务配置**

 

你作为 A 公司的安全运营人员，当前有一部 Linux 系统的 VSFTPD 服务需要配置，请按照下面要求完成相关操作，保障系统安全运行。

\1.    配置启用 VSFTPD 虚拟用户的配置是；

`guest_enable=YES`

\2.    配置启用 VSFTPD 虚拟用户文件，用户名 admin 密码 admin 用户文件中如何表示；

```
[root@localhost ~]# vim /vftp/vuser.txt
admin
admin
```

\3.    配置修改 VSFTPD 服务端口为 2200，firewalld 防火墙需要进行的操作是；

```bash
[root@localhost ~]# firewall-cmd --permanent --add-port=2200/tcp
success
[root@localhost ~]# firewall-cmd --reload
success
```



\4.    配置修改 VSFTPD 服务端口为 2200，selinux 需要进行的操作是；

```
[root@localhost ~]# semanage port -a -t ftp_port_t -p tcp 2200
[root@localhost ~]# semanage port -l -C
SELinux 端口类型                   协议       端口号

ftp_port_t                     tcp      2200
```



\5.    配置修改 VSFTPD 服务公共文件夹至/srv/ftp/share，selinux 需要进行的配置是；

```bash
[root@localhost ~]# ls -Z /srv/ftp/
unconfined_u:object_r:public_content_t:s0 share
[root@localhost ~]# semanage boolean -l | grep ftp
ftpd_anon_write                (关    ,    关)  Allow ftpd to anon write
ftpd_connect_all_unreserved    (关    ,    关)  Allow ftpd to connect all unreserved
ftpd_connect_db                (关    ,    关)  Allow ftpd to connect db
ftpd_full_access               (关    ,    关)  Allow ftpd to full access
ftpd_use_cifs                  (关    ,    关)  Allow ftpd to use cifs
ftpd_use_fusefs                (关    ,    关)  Allow ftpd to use fusefs
ftpd_use_nfs                   (关    ,    关)  Allow ftpd to use nfs
ftpd_use_passive_mode          (关    ,    关)  Allow ftpd to use passive mode
httpd_can_connect_ftp          (关    ,    关)  Allow httpd to can connect ftp
httpd_enable_ftp_server        (关    ,    关)  Allow httpd to enable ftp server
tftp_anon_write                (关    ,    关)  Allow tftp to anon write
tftp_home_dir                  (关    ,    关)  Allow tftp to home dir
[root@localhost ~]# setsebool ftpd_full_access on
root@localhost ~]# getsebool  ftpd_full_access
ftpd_full_access --> on
```



\6.    使用 hdyra 工具破解 vsftpd 服务密码的命令（用户名：admin 密码字典：password.txt ）是；

`hdyra -l admin -P password.txt ip-address ftp`

\7.    使用 medusa 工具破解 vsftpd 服务密码的命令（用户名：admin 密码字典：password.txt ）是。

 

**任务五 文件共享服务配置**

 

你作为 A 公司的安全运营人员，当前有一部 Linux 系统的文件共享服务需要



 

配置，请按照下面要求完成相关操作，保障文件共享系统安全运行。

\1.    Linux 操作系统使用 yum 包管理器安装文件共享服务的命令是；

```
[root@localhost ~]# yum install -y samba
```

\2.    Linux 操作系统配置文件共享目录在/srv/samba，selinux 需要进行的配置是；

```
[root@localhost srv]# chcon -R -t samba_share_t /srv/smb/
[root@localhost srv]# ls -Z /srv/
unconfined_u:object_r:public_content_t:s0 ftp     unconfined_u:object_r:samba_share_t:s0 smb
```



\3.    Linux 操作系统配置文件共享服务**用户**的命令是；

```
samba服务与本地账户的关系是：用户名一样，但是密码不一样。设置本地用户的smb密码需要使用的命令是：smbpasswd username
```

`smbpasswd`

\4.    Linux 操作系统配置文件共享服务用户，创建新用户 share 的命令是；

```bash
# 要设置smb用户，必须保证本地拥有该用户
[root@localhost ~]# useradd user001
[root@localhost ~]# smbpasswd -a share
New SMB password:
Retype new SMB password:
Added user share.
```

\5.    Linux 操作系统配置文件共享服务匿名用户访问配置是；

```
[root@localhost ~]# mkdir /samba/share -p
[root@localhost ~]# vim /etc/samba/smb.conf
[anon_share]
path = /samba/share
public=yes
[root@localhost ~]# systemctl restart smb.service
```

\6.    Linux 操作系统配置文件共享服务共享打印机，默认共享名是；

`Print`

\7.    smbclient 工具查看服务器 192.168.1.100 下存在哪些共享目录使用的命令是。

 ```
 [root@samba ~]# smbclient -L 192.168.231.130
 ```



**任务六 证书管理服务配置**

 

你作为 A 公司的安全运营人员，当前有一部 Linux 系统的证书管理服务需要配置，请按照下面要求完成相关操作，保障证书分发系统安全运行。

\1.  使用 cfssl 工具查看默认请求配置信息使用的命令是

```bash
[root@localhost ~]# cfssl print-defaults config
{
    "signing": {
        "default": {
            "expiry": "168h"
        },
        "profiles": {
            "www": {
                "expiry": "8760h",
                "usages": [
                    "signing",
                    "key encipherment",
                    "server auth"
                ]
            },
            "client": {
                "expiry": "8760h",
                "usages": [
                    "signing",
                    "key encipherment",
                    "client auth"
                ]
            }
        }
    }
}
```



\2.  使用 cfssl 工具初始化 CA 证书使用的命令是；

```
[root@localhost cfssl]# cp csr.json ca-csr.json
[root@localhost cfssl]# vim ca-csr.json
{
    "CN": "server",
    "key": {
        "algo": "rsa",		# 指定加密算法
        "size": 2048		# 指定密钥长度
    },
    "names": [
        {
            "C": "CN",			# 指定国家
            "ST": "GunagDong",	# 指定省份
            "L": "ShenZhen"		# 指定城市
        }
    ]
}
```

\3.  使用 cfssl 工具初始化服务器证书使用的命令是；

```
[root@localhost cfssl]# cfssl gencert -initca ca-csr.json | cfssljson -bare ca
2023/05/24 02:52:05 [INFO] generating a new CA key and certificate from CSR
2023/05/24 02:52:05 [INFO] generate received request
2023/05/24 02:52:05 [INFO] received CSR
2023/05/24 02:52:05 [INFO] generating key: rsa-2048
2023/05/24 02:52:05 [INFO] encoded CSR
2023/05/24 02:52:05 [INFO] signed certificate with serial number 435324584926603866224607034223788757067404112011
[root@localhost cfssl]# ls
ca.csr  ca-csr.json  ca-key.pem  ca.pem  config.json  csr.json

知识点：ca-kay.pem（私钥） ca.pem（公钥）
```



\4.  使用 cfssl 工具吊销 test 证书使用命令是；

```
cfssl revoke -db <certificate-db> -cert test.pem
<certificate-db>是指向包含证书数据库的路径，该数据库跟踪所有已签发的证书。
```



\5.  使用 openssl 工具生成 rsa 密钥的命令是；

```bash
[root@localhost ~]# openssl genrsa --out key.key
Generating RSA private key, 2048 bit long modulus (2 primes)
.....................................................................................+++++
..+++++
e is 65537 (0x010001)
```



\6.  使用 openssl 工具查看证书信息的命令是。

```
[root@localhost app1]# openssl x509 -in /etc/pki/CA/certs/app1.crt -noout -issuer
issuer=C = CN, ST = guangdong, L = shenzhen, O = sziit, OU = sziit, CN = ca.sziit.org, emailAddress = 123456789@qq.com
```



 

# 第三阶段： 应急响应

**背景：**作为信息安全技术人员必须能够掌握内容镜像分析、重要数据恢复、恶意文件分析等相关技能，利用这些技能我们能够第一时间分析相关恶意文件、分析蛛丝马迹帮助我们更好的完成应急响应工作。

应急响应阶段题目主要包含：Windows 内存镜像分析，Linux 内存镜像分析， 磁盘文件恢复，恶意程序分析等内容。

 

 

**项目** 1.   **内存镜像分析**

 

**任务一** Windows **内存镜像分析**

 

你作为 A 公司的应急响应人员，请分析提供的内存文件按照下面的要求找到相关关键信息，完成应急响应事件。

\1.    从内存中获取到用户admin 的密码并且破解密码，以Flag{admin,password}形式提交(密码为 6 位)；

```bash
# hashdump 插件查看系统的 C:\Windows\System32\config\SAM 文件信息
用户名:用户ID:密码哈希:密码哈希附加盐
┌──(root㉿pinginglab)-[/home/pinginglab/桌面]
└─# vol.py --profile=Win7SP1x64 -f mem.dump hashdump                            
Volatility Foundation Volatility Framework 2.6.1
Administrator:500:6377a2fdb0151e35b75e0c8d76954a50:0d546438b1f4c396753b4fc8c8565d5b:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
```

密码破解

```
网站：https://crackstation.net/
直接将密码哈希丢进去就行
```

<img src="%E9%87%91%E7%A0%96%E6%A0%B7%E9%A2%98-2022.assets/image-20230614200100103.png" alt="image-20230614200100103" style="zoom:50%;" />

\2.    获取当前系统 ip 地址及主机名，以 Flag{ip:主机名}形式提交；

通过`netscan`查看IP地址，可以看到IP地址位：192.168.231.128

```bash
┌──(root㉿pinginglab)-[/home/pinginglab/桌面]
└─# vol.py --profile=Win7SP1x64 -f WIN-S5IJVUKO930-20230614-104711.raw netscan  
Volatility Foundation Volatility Framework 2.6.1
+
Offset(P)          Proto    Local Address                  Foreign Address      State            Pid      Owner          Created
0x7d61eba0         UDPv6    fe80::6167:a4ad:b45:1956:54210 *:*                                   2828     svchost.exe    2023-06-14 10:43:55 UTC+0000
0x7d61f570         UDPv6    fe80::59a2:bfb8:bca:424b:54209 *:*                                   2828     svchost.exe    2023-06-14 10:43:55 UTC+0000
0x7d620d70         UDPv6    ::1:54211                      *:*                                   2828     svchost.exe    2023-06-14 10:43:55 UTC+0000
0x7d622010         UDPv4    **192.168.231.128:54213**          *:*                                   2828     svchost.exe    2023-06-14 10:43:55 UTC+000
```

查看主机名

通过`hievlist`查看注册表列表

```bash
┌──(root㉿pinginglab)-[/home/pinginglab/桌面]
└─# vol.py --profile=Win7SP1x64 -f mem.dump hivelist                                                    
Volatility Foundation Volatility Framework 2.6.1
Virtual            Physical           Name
------------------ ------------------ ----
0xfffff8a001cfd010 0x0000000039828010 \??\C:\Users\Administrator\AppData\Local\Microsoft\Windows\UsrClass.dat
0xfffff8a002fa2010 0x0000000013a3f010 \??\C:\System Volume Information\Syscache.hve
0xfffff8a00000f010 0x0000000023385010 [no name]
0xfffff8a000024010 0x0000000023510010 \REGISTRY\MACHINE\SYSTEM			// 系统信息：主机名一般在这里
0xfffff8a000064010 0x0000000023552010 \REGISTRY\MACHINE\HARDWARE		// 硬件信息
0xfffff8a0000e7410 0x0000000011bcc410 \??\C:\Windows\ServiceProfiles\NetworkService\NTUSER.DAT
0xfffff8a000100360 0x0000000015346360 \SystemRoot\System32\Config\SECURITY
0xfffff8a0003f4410 0x000000001527d410 \SystemRoot\System32\Config\DEFAULT
0xfffff8a0007ae010 0x000000001d867010 \Device\HarddiskVolume1\Boot\BCD
0xfffff8a0012d4010 0x000000001c938010 \SystemRoot\System32\Config\SOFTWARE
0xfffff8a001590010 0x000000001151a010 \SystemRoot\System32\Config\SAM		// 用户SAM文件
0xfffff8a0015ca010 0x00000000111a3010 \??\C:\Windows\ServiceProfiles\LocalService\NTUSER.DAT
0xfffff8a001c34010 0x0000000039803010 \??\C:\Users\Administrator\ntuser.dat

# 由于信息很长，这里必须要重定向写入文件好做二次分析
┌──(root㉿pinginglab)-[/home/pinginglab/桌面]
└─# vol.py --profile=Win7SP1x64 -f mem.dump hivedump -o 0xfffff8a000024010 > name.txt

# 查看 name.txt 并寻找计算机名的存储路径
┌──(root㉿pinginglab)-[/home/pinginglab/桌面]
└─# nano name.txt
```

<img src="%E9%87%91%E7%A0%96%E6%A0%B7%E9%A2%98-2022.assets/image-20230614214358489.png" alt="image-20230614214358489" style="zoom:50%;" />

使用`printkey -k`选项查看主机名

```bash
┌──(root㉿pinginglab)-[/home/pinginglab/桌面]
└─# vol.py --profile=Win7SP1x64 -f mem.dump printkey -K 'ControlSet001\Control\ComputerName\ComputerName'
Volatility Foundation Volatility Framework 2.6.1
Legend: (S) = Stable   (V) = Volatile

----------------------------
Registry: \REGISTRY\MACHINE\SYSTEM
Key name: ComputerName (S)
Last updated: 2019-10-15 02:56:15 UTC+0000

Subkeys:

Values:
REG_SZ                        : (S) mnmsrvc
REG_SZ        ComputerName    : (S) USER-O27N6483CQ
```



\3.    获取当前系统浏览器搜索过的关键词，作为 Flag 提交；

```bash
# 查看ie浏览器历史记录
┌──(root㉿pinginglab)-[/home/pinginglab/桌面]
└─# vol.py --profile=Win7SP1x64 -f WIN-S5IJVUKO930-20230614-104711.raw iehistory
Volatility Foundation Volatility Framework 2.6.1
**************************************************
Process: 2652 explorer.exe
Cache type "URL " at 0x7305000
Record length: 0x100
Location: Cookie:pinginglab@sogou.com/
Last modified: 2023-06-14 10:43:43 UTC+0000
Last accessed: 2023-06-14 10:43:43 UTC+0000
File Offset: 0x100, Data Offset: 0x88, Data Length: 0x0
File: pinginglab@sogou[1].txt
```

\4.    当前系统中存在挖矿进程，请获取指向的矿池地址，以 Flag{ip:端口}形式提交；

思路：通过 `pslist`查看进程分析信息

\5.    恶意进程在系统中注册了服务，请将服务名以 Flag{服务名}形式提交。

 

 

**项目** ***2.\***   **机密数据恢复**

 

**任务二 财务数据恢复**

 

你作为 A 公司的应急响应人员，请分析提供的磁盘文件按照下面的要求找到相关关键信息，完成应急响应事件。

\1.    分析磁盘镜像中的文件系统，找到关键财务证据一

\2.    分析磁盘镜像中的文件系统，找到关键财务证据二

\3.    分析磁盘镜像中的文件系统，找到关键财务证据三

\4.    分析磁盘镜像中的文件系统，找到关键财务证据四

\5.    分析磁盘镜像中的文件系统，找到关键财务证据五

\6.    分析磁盘镜像中的文件系统，找到关键财务证据六

\7.    分析磁盘镜像中的文件系统，找到关键财务证据五

\8.    分析磁盘镜像中的文件系统，找到关键财务证据六





**任务三 快递运单信息恢复**

 

你作为 A 公司的应急响应人员，请分析提供的流量包文件按照下面的要求找到相关关键信息，完成应急响应事件。

\1.    分析提供的流量包，找到系统运单信息相关数据一

\2.    分析提供的流量包，找到系统运单信息相关数据二

\3.    分析提供的流量包，找到系统运单信息相关数据三

\4.    分析提供的流量包，找到系统运单信息相关数据四

\5.    分析找到的运单系统管理员的密码库，尝试破解密码一

\6.    分析找到的运单系统管理员的密码库，尝试破解密码二

\7.    分析找到的运单系统管理数据，找到关键运单记录一

\8.    分析找到的运单系统管理数据，找到关键运单记录二

 

**任务四 加密系统破解**

 

你作为 A 公司的应急响应人员，请分析提供的残缺脚步文件按照下面的要求找到相关关键信息，完成应急响应事件。

\1.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F1 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\2.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F2 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\3.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F3 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\4.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F4 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\5.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景SSH 服务登录密码的功能，填写该文件当中空缺的 F5 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\6.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F6 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\7.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F7 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；



 

\8.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F8 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\9.    编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，填写该文件当中空缺的 F9 字符串，将该字符串通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交；

\10.  编辑 Python 程序 ssh_brute_force.py 文件，利用 superdic.txt 密码字典文件，使该程序实现暴力破解服务器场景 SSH 服务登录密码的功能，运行该程序，将程序运行后得到的正确密码通过 SHA256 运算后返回哈希值的十六进制结果作为 Flag 值（形式：十六进制字符串）提交。

 

 

**项目** 3.   APT **攻击溯源**

 

**任务五 攻击流量溯源**

 

你作为 A 公司的应急响应人员，公司内某重要部门操作 APT 攻击，现捕获到相关流量请你按照下面的要求找到关键信息，完成应急响应事件。

\1.    使用Wireshark 查看并分析服务器场景桌面下的login.pcapng 数据包文件， 通过分析数据包 login.pcapng 的第 130 号报文，找出黑客提交的有效命令，并将该有效命令作为 FLAG（形式：[命令]）提交；

\2.    继续查看数据包文件 login.pacapng，分析出黑客又执行了什么命令，并将该有效命令作为 FLAG（形式：[命令]）提交；

\3.    继续查看数据包文件 login.pacapng 分析出黑客执行上述命令后，得到的结果中的多个 IP 地址作为 FLAG（形式：[IP 地址 1:IP 地址 2:IP 地址 n]） 提交；

\4.    继续查看数据包文件 login.pacapng 分析出黑客执行上述命令后，得到的结果中的最后 1 个物理地址作为 FLAG（形式：[物理地址]）提交；

\5.    继续查看数据包文件login.pacapng 分析出黑客建立映射使用的有效命令， 并将该命令中的 IP 地址作为 FLAG（形式：[IP 地址]）提交；

\6.    继续查看数据包文件login.pacapng 分析出黑客建立映射使用的有效命令， 并将该命令中的用户名作为 FLAG（形式：[用户名]）提交；

\7.    继续查看数据包文件login.pacapng 分析出黑客建立映射使用的有效命令， 并将该命令中的密码作为 FLAG（形式：[密码]）提交。



**任务五 例题**

 挑战:提供了带有攻击数据的网络跟踪。(请注意，受害者的IP地址已被更改，以隐藏真实位置。)分析并回答以下问题:



1. 涉及哪些系统(即IP地址)?(2分)

   <img src="%E9%87%91%E7%A0%96%E6%A0%B7%E9%A2%98-2022.assets/image-20230614220127947.png" alt="image-20230614220127947" style="zoom:50%;" />

   `{98.114.205.102; 192.150.11.111}`

2. 攻击机IP地址(2分)

   攻击机IP地址：{98.114.205.102}

3. 转储文件中包含多少TCP会话?(2分)

   <img src="%E9%87%91%E7%A0%96%E6%A0%B7%E9%A2%98-2022.assets/image-20230614220625835.png" alt="image-20230614220625835" style="zoom:50%;" />

   `{5个}`

4. 这次攻击花了多长时间?(2分)

   {16秒}

5. 攻击的目标是哪个操作系统?哪种服务?漏洞?(6分)

   ```
   ms04-011 漏洞：黑客可以利用该漏洞直接使用管理员权限做远程命令执行
   ```

   `{winXP; SMB; 445}`

6. 您能否概述一下攻击者执行的一般操作?(6分)

   `黑客通过445端口获取了远程命令执行权限，并下载了恶意软件：ssms.exe，最后执行`

   <img src="%E9%87%91%E7%A0%96%E6%A0%B7%E9%A2%98-2022.assets/image-20230614224712969.png" alt="image-20230614224712969" style="zoom:50%;" />

7. 攻击了哪些特定的漏洞?(2分)

   `ms04-011`

   

数据包分析练习网站：https://www.malware-traffic-analysis.net/training-exercises.html